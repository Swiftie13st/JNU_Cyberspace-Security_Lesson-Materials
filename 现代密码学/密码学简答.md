### 密钥管理
密钥管理包括了密钥的**产生、存储、分配、组织、使用、更换和销毁**等一系列技术问题。
### 为什么要数字签名
数字签名具有的性质：**完整性、身份唯一性（不可伪造性）、不可否认性（公开可验证性）**
数字签名主要的功能是：保证信息传输的完整性、发送者的身份认证、防止交易中的抵赖发生。
数字签名技术是将摘要信息用发送者的私钥加密，与原文一起传送给接收者。接收者只有用发送的公钥才能解密被加密的摘要信息，然后用HASH函数对收到的原文产生一个摘要信息，与解密的摘要信息对比。如果相同，则说明收到的信息是完整的，在传输过程中没有被修改，否则说明信息被修改过，因此数字签名能够验证信息的完整性。
### 简述数字签名的过程和应用。
用户A将待发送的信息原文经散列函数运算生成摘要信息，并用自己的私有密钥对摘要信息进行加密，将形成的密文和原文传送给用户B。
用户B接收到密文后，使用A的公开密钥验证密文，得到摘要信息，并按照约定的摘要算法对原文进行摘要运算，再将两个摘要值进行比对，一致则表明数据未被篡改。
最常见的用处就是用来认证一个网站的身份。经常碰到数字签名的——代码签名。比特币是一种匿名的数字货币，它的身份认证是基于ECDSA。
### 简述信息隐藏技术和加密技术的区别。
信息隐藏是把机密信息隐藏在大量信息中不让对手发觉的一种方法。
信息隐藏的方法主要有隐写术、数字水印、可视密码、潜信道、隐匿协议等。
信息加密技术是利用数学或物理手段，对电子信息在传输过程中和存储体内进行保护，
以防止泄漏的技术。保密通信，计算机密钥，防复制软盘 等都属于信息加密技术。
通信过程中的加密主要是采用密码，在数字通信中可利用计算机采用加密法，
改变负载信息的数码结构。
### 什么是单点登录技术，目前实现单点登录的方式有哪些？
单点登录（Single Sign On, SSO）是指在同一帐号平台下的多个应用系统中，用户只需登录一次，即可访问所有相互信任的应用系统。
实现方式一：父域 Cookie
实现方式二：认证中心
实现方式三：LocalStorage 跨域
### 什么是公钥基础设施PKI？它有什么作用？
PKI 即”公钥基础设施”，是一种遵循既定标准的密钥管理平台,它能够为所有网络应用提供加密和数字签名等密码服务及所必需的密钥和证书管理体系
简单来说，PKI就是利用公钥理论和技术建立的提供安全服务的基础设施。PKI技术是信息安全技术的核心，也是电子商务的关键和基础技术。

PKI技术的广泛应用能满足人们对网络交易安全保障的需求
利用PKI技术，SSL协议允许在浏览器和服务器之间进行加密通信
PKI技术可以保证Web 交易多方面的安全需求，使Web上的交易和面对面的交易一样安全。

### 什么是数字证书？它是如何生成的？
数字签名证书实际上就是对公钥进行数字签名，它是对公钥合法性提供证明的技术。
服务器将公钥A给CA（公钥是服务器的）
CA用自己的私钥B给公钥A加密，生成数字签名A
CA把公钥A，数字签名A，附加一些服务器信息整合在一起，生成证书，发回给服务器。

### 对称密钥体制与公钥密码体制的各有什么特点？
#### 对称密钥
优点：加密、解密处理快，具有很高的数据吞吐率，保密度高，密钥相对较短
缺点：
1. 密钥分发过程复杂，所花代价高
2. 多人通信时，密钥组合的数量会出现爆炸性膨胀
3. 通信双方必须统一密钥，才能发送保密信息
4. 接收方可以伪造签名，发送方可以否认发送过的某信息

#### 公开密钥
优点：网络中的每个用户只需保护自己的私钥，密钥少，便于管理密钥分配简单
可以实现数字签名
缺点：加密解密处理速度慢，同等安全强度下公开密钥体制的密钥位数要求多一些
### 简述数字信封的加密和解密过程。
数字信封的加密过程是：发送方使用对称密钥对内容进行加密，使用接收方的公钥对前面的对称密钥进行加密，将前面两者发送给接收方。
数字信封的解密过程是：接收方接收到加密的对称密钥和加密的内容后，使用自己的私钥解密对称密钥，然后使用对称密钥对内容进行解密。
### 什么是重放攻击？重放攻击的类型有哪些?
指攻击者发送一个目的主机已接收过的包，来达到欺骗系统的目的，主要用于身份认证过程，破坏认证的正确性。
第一种是直接重放，即重放给原来的验证端，直接重放的发送方和接收方均不变。
第二种是反向重放，将原本发给接收方的消息反向重放给发送方。
第三种是第三方重放，将消息重放给域内的其他验证端。
### 请分别用对称密码体制和公钥密码体制实现消息认证，其中，采用公钥加密体制实现消息认证时，要同时满足机密性要求。
发送方A和接收方B事先共享一个密钥k,A用密钥k对消息M加密后通过公开信道传送给B，B接收到密文消息后，
通过是否能用密钥k将其恢复成合法明文来判断消息是否来自A，信息是否完整。
采用公钥密码体制进行消息认证，发送方A用自己的私钥进行加密运算（数字签名）之后，再用接收方B的公钥进行加密，
从而实现机密性，这种方法能提供机密性、数字签名和鉴别。
### 小强想出了一种数字签名的新方案，他用一个随机的对称密钥加密要签名的明文得到密文，再用自己的私钥加密该对称密钥（签名），然后把密文和加密后的对称密钥一起发送给接收方，接收方如果能解密得到明文，就表明验证签名成功。请问用该方案签名存在哪种缺陷？ 如何实现带有保密性要求的数字签名？
该方案存在的缺陷为签名无法和消息绑定在一起，对方可以用对称密钥加密另一个明文，声称是小强签名的。
发送方首先对消息用Hash函数求消息摘要（散列值），然后发送方用其私钥加密该散列值，这个被发送方私钥加密的散列值就是数字签名，将其附在文件后，
然后将明文和数字签名的组合体用一个对称密钥k加密，再用接收方的公钥对k加密，最后将加密后的组合体一起发送给接收方就可以让其验证签名了 。

### 公钥密码体制的加密变换和解密变换应满足哪些条件？小明想出了一种公钥加密的新方案，他用自己的公钥加密信息，然后将自己的私钥传给接收方，供接收方解密用，请问这种方案存在什么缺陷吗？应该怎么调整？
公钥密码体制的加密变换和解密变换应满足的条件：
（1）对任意明文进行加密变换是很容易的，并且若知道解密密钥，那么对密文的解密也是很容易的；
（2）信息的发送方对任意明文进行加密变换后，接收方进行解密变换就可以得到明文；
（3）若不知道解密密钥，那么即使知道加密密钥，具体的加密与解密算法以及密文，确定明文在计算上也是不可行的。
私钥在传输途中可能被攻击者窃取。这相当于把公钥密码体制当做对称密码体制在用，因此无法解决密钥分配过程中被窃取的问题。
正确的应该是小明用自己的私钥加密信息，他的公钥是公开的，接收方接收到信息后，直接用他的公钥去解密信息。

### 由于数字证书可以用来分发公钥，因此可以利用证书中的公钥及其对应的私钥进行加密和签名，请描述使用数字证书同时进行签名和加密的步骤。

①发送方准备好要传送给接收方的信息（明文）；
② 发送方对该信息进行Hash运算，得到一个消息摘要；
③ 发送方用自己证书对应的私钥对消息摘要进行加密得到自身的数字签名，并将其附在信息后；
④ 发送方获取接收方的数字证书，并验证该证书有效后，用接收方证书中的公钥加密信息和签名的混合体；
⑤ 接收方收到加密的数据后，用自己证书对应的私钥解密密文，得到信息和数字签名的混合体；
⑥ 接收方获取发送方的数字证书，并验证该证书有效后，就用发送方证书中的公钥解密数字签名，得到一个消息摘要，再对明文信息求消息摘要 。


### 信息安全的基本概念：主动攻击和被动攻击的行为和预防措施，对信息安全起决定性影响的要素有哪些。
主动攻击:中断 篡改 伪造
被动攻击:获取消息的内容.进行业务流分析

密码学包含密码编码学和密码分析学，密码编码的主要方法有置换，替代和代数，
密码分析的方法：惟密文攻击、已知明文攻击、选择明文攻击、选择密文攻击，分别代表不同的攻击难度。
攻击强度：选择密文攻击 > 选择明文攻击 > 已知明文攻击 > 唯密文攻击 但是实现的难易程度：也是相反的。

### 信息安全五个目标，每种安全目标的含义和所要使用的密码学方法。
1. 保密性:加密
2. 真实性
3. 完整性:数字签名
4. 可用性
5. 不可否认性

###  对称密码学：NIST标准DES算法和AES算法的密钥大小，分组大小和各种工作模式；
1. DES的数据块大小为8个字节，而AES的数据块大小为16个字节。
2. DES的密钥长度是64位（其中8位用于校验），而AES的密钥长度是128位（AES算法比DES算法更安全）

### 单向散列函数的基本性质有哪些 以及生日攻击的原理。
加密后密文的长度是定长的 具备单向性,不可以逆推反算
将生日悖论的问题抽象成散列函数，教室里每个人作为函数的输入x，每个人对应的生日作为函数的输出y，那么可以写成H（x）= y，
生日攻击就是利用散列函数发生碰撞的可能性，进行n次尝试直到找到一对碰撞的输入

Hash函数分为带密钥的Hash函数（whirlpool） 和不带密钥的Hash函数（MD，SHA）。
可以使用带密钥的Hash函数实现认证功能。

### 公钥密码学 DH密钥交换，RSA算法， ELgamal算法的基本流程和操作。
DH密钥 ：
双方各自生成自己的私钥和公钥，私钥仅对自己可见，然后交换公钥，并根据自己的私钥和对方的公钥，生成最终的密钥
RSA算法：
选取大素数$p,q$;计算$n=pq$以及$n$的欧拉函数
Elgamal算法：
它是一种基于离散对数难题的加密体系
首先选择一个素数$p$，两个随机数, $g$ 和$x$，$g, x < p,$ 计算 $y = g^x \pmod p$，则其公钥为 $y, g$ 和$p$。私钥是$x$。
$g$和$p$可由一组用户共享。ElGamal用于数字签名。被签信息为$M$，首先选择一个随机数$k$, $k$与$p - 1$互质，计算
$$a = g^k \pmod p$$
再求解$b$：
$$M = xa + kb\pmod {p -1}$$
签名就是( a, b )。

###  数字签名算法的原理，什么是公钥PKI，它有什么作用？它的应用有哪些。
PKI是一种遵循标准的利用公钥加密技术为电子商务提供一套安全基础平台的技术和规范
PKI技术的广泛应用能满足人们对网络交易安全保障的需求
PKI的应用非常广泛，包括在web服务器和浏览器之间的通讯、电子邮件、电子数据交换（EDI）、在Internet上的信用卡交易和虚拟私有网（VPN）等。

###  密钥层次管理的方法：主密钥，密钥加密密钥和会话密钥？什么是会话密钥？抵抗重放攻击的方法有哪些？CA的工作原理。
主密钥 即TMK，主要作用是用来验证工作密钥是否合法，以及加密TPK（终端PIN密钥），保证TPK在传输线路上的安全性。
会话密钥也称为数据加密密钥，或者工作密钥，是保证用户跟设备或者两台设备之间安全通信会话而随机产生的加密和解密密钥，它可由通信用户之间进行协商得到。
1.加随机数2. 加时间戳3. 加流水号
服务器产生的公钥就交给CA，CA用CA自己的私钥加密，即数字签名，加密生会生成证书，证书还是要交给服务端，放在服务端那边。
当客户端访问服务端时，服务端就会把这个证书安装到客户端上。客户端就会用CA提供的CA自己的公钥来解密这个证书，
解得开就说明这个证书是某个CA认证过了的，是可信的，解开后就会得到数据，而这个数据就是服务端的公钥，此时用这个公钥与服务端进行数据传输

###  协议相关。IPSEC，SSL/TLS, SET协议的目标和工作原理。
IPSec的主要目标是保护IP包，IPSec由策略和筛选器组成
SSL协议与TLS协议紧密关联，用户启用SSL后，SSL安全会话将被启动，公钥将会为会话创建唯一的会话密钥，并对信息加密。
TLS协议是用来保护互联网上传输信息私密性的工业标准协议

公钥体制的基本原理是单向陷门函数。
### 对称密钥体制与公钥密码体制的各有什么特点？
#### 对称密钥
优点：加密、解密处理快，具有很高的数据吞吐率，保密度高，密钥相对较短
缺点：
1. 密钥分发过程复杂，所花代价高
2. 多人通信时，密钥组合的数量会出现爆炸性膨胀
3. 通信双方必须统一密钥，才能发送保密信息
4. 接收方可以伪造签名，发送方可以否认发送过的某信息

#### 公开密钥
优点：网络中的每个用户只需保护自己的私钥，密钥少，便于管理密钥分配简单
可以实现数字签名
缺点：加密解密处理速度慢，同等安全强度下公开密钥体制的密钥位数要求多一些
# 要求
### 公钥密钥对参数生成需满足的要求：
- 公开密钥(public-key), 可以被任何人知道, 用于加密或验证签名；
- 私钥(private-key), 只能被消息的接收者或签名者知道,用于解密或签名；
- 由私钥及公开参数容易计算出公开密钥；
- 由公钥及公开参数推导私钥是困难的； 

### 公钥密码体制的要求：
- 产生一对密钥在计算上是可行的；
- 已知公钥和明文，产生密文是容易的；
- 接收方利用私钥来解密密文在计算上是可行的；
- 对于攻击者，利用公钥来推断私钥在计算上是不可行的；
- 已知公钥和密文，在不知道私钥的情况下，恢复明文在计算上是不可行的。


# RSA
## 密钥生成
1. 选一对不相等且足够大的质数$p,q$
2. 计算$n=p\times q$
3. 计算$n$的欧拉函数\varphi (n)=(p-1)\times(q-1)$
4. 选一个与$\varphi (n)$互质的整数$e$，$1<e<\varphi(n)$且$gcd(\varphi(n),e)=1$
5. 计算$e$在模$\varphi (n)$逆元$d$，$d\times e \equiv 1 \mod\varphi(n)$
6. 以$\{e,n\}$为公开钥（𝑃𝐾）,$\{d,n\}$为秘密钥（𝑆𝐾）

例：$29\times d \mod 264 = 1$，求$d$：
用辗转相除法可以转换为下列式子：
（1）$29 \times d - 264 \times k = 1$
（2）$29 \times d - 3 \times k = 1$
（3）$2 \times d - 3 \times k = 1$
（4）$2 \times d - 1 \times k = 1$
此时$k$的系数以及化为$1$;
令$d=1$，带入（4）式中，得$k=1$；
令$k=1$，带入（3）式中，得$d=2$；
令$d=2$，带入（2）式中，得$k=19$；
令$k=19$，带入（1）式中，得$d=173$；
解得：$d=173$
## 加密
加密时首先将明文比特串分组，使得每个分组对应的十进制数小于$n$，即分组长度小于$\log_2n$。然后对每个明文分组$m$，作加密运算：
$$C \equiv m^e \mod n$$
## 解密
对密文分组的解密运算为：
$$M \equiv c^d \mod n$$
# ElGamal
## 密钥生成
1. 对于Bob,首先要随机选择一个大素数$p$，且要求$p-1$有大素数因子。再选择一个模$p$的本原元$g$。将$p$和$g$公开。
   我们为了方便计算取$p = 37$,则$37$的一个本原元$g = 2$.
2. 随机选择一个整数$x$作为密钥，$2\le x \leq p-2$。
	我们选择$x = 5$,
3. 计算$y\equiv g^x\pmod p$
	$\beta=2^5\pmod {37} = 32$

以$(y,g,p)$作为公开密钥，$x$作为秘密密钥。
#### K是否需要保密？K能否重复使用？
需要，$K$泄露，则由$y$和$C_2$可以解出$M$
攻击者若已知$k$，可以计算$y^k$,然后用$C_2/y^k$就得到明文；
若是$k$重复使用，则$C_2/C_2'=M/M'$,知道其中的一个明文，另一个可求。

## 加密
假设Alice 想发送消息 $M = 29$
1. 首先选取随机数$k$ , $0 \le k \le p-1$
假设$k = 7$，计算密文对$C = \{C1, C2\}$
则：$C_1 = g^k \mod p = 2^7 \mod 37 = 17$
$C_2 = M \times y^k \mod p = 29\times 32^7 \mod 37 = 33$
2. 将密文$C = \{17,33\}$发送给Bob

## 解密
Bob收到密文$C = \{17,33\}$后恢复明文如下：
$M = C_2 (C_1^x) ^{-1} \mod p$
$= 33 \times(17^5) ^{-1} \mod 37$
$= 33\times 2 \mod 37$
$= 29$

## EDCH体制
假定椭圆曲线𝐸定义在$Z_q$域（$q$为素数）上。设$P$为$E$上的一个点。A和B分别选$a$和$b$予以保密，但将$aP, bP\in E$公开。A、B间通信用的密钥为$abP$，这是第三者无法得知的。 
两用户A和B之间的密钥交换如下进行： 
1. A选一小于$n$的整数$n_A$，作为秘密钥，并由$P_A=n_AG$产生$E_p(a,b)$上的一点作为公开钥。
2. B类似地选取自己的秘密钥$n_B$和公开钥$P_B$。
3. A、B分别由$K=n_AP_B$和$K=n_BP_A$产生出双方共享的秘密钥。
这是因为$K=n_AP_B=N_A(n_BG)=n_B(n_AG)=n_BP_A$。
攻击者若想获取$K$，则必须由$P_A$和$G$求出$n_A$，或由$P_B$和$G$求出$n_B$，即需要求椭圆曲线上的离散对数，因此是不可行的。

例$p=211$，$E_p(0,-4)$，即椭圆曲线为$y^2\equiv x^3-4$，$G=(2,2)$是$E_{211}(0,-4)$的阶为$241$的一个生成元，即$241G=O$。
A的秘密钥取为$n_A=121$，公开钥为$P_A=121(2,2)=(115,48)$。
B的秘密钥取为$n_B=203$，公开钥为$P_B=203(2,2)=(130,203)$。
由此得到的共享密钥为$121(130,203)=203(115,48)=(161,169)$，即共享密钥是一对数。
## Fermat定理
若p是素数，a为任意正整数，若a与p互素，则 
$$a^{p-1}\pmod p = 1$$
例：计算$2^{43210}\pmod {101}$：
因为$2^{100}\equiv1\pmod{101}$
所以$2^{43210}\pmod {101}=(2^{100})^{432}2^{10}$
$\equiv1^{432}2^{10}\equiv1024$
$\equiv14\pmod{101}$
## Euler定理
### Euler函数 ：
小于$m$且与$m$互素的正整数的个数称为$m$的Euler函数，记为$\Phi(m)$, 习惯上$\Phi(1)=1$。
1. 若p是素数，则：
   $$\Phi(p)=p-1$$
   例如：$p=13$,小于$13$的数$1,2,3,4,5,6,7,8,9,10,11,12$都与$13$互	素。 $\Phi(13)=12$
2. 若$m,n$互素，即$gcd(m,n)=1$，有
	$$\Phi(mn)= \Phi(m) \times\Phi(n)$$
	例如: $\Phi (5\times6)= \Phi (5) \Phi(6)=\Phi(5) \Phi(2) \Phi(3)=4\times1\times2=8$
	进一步，若$n_1,n_2,\ldots,n_m$两两互素，则
	$$Φ(n_1n_2…n_m)=\Phi ( n_1) \Phi( n_2)\ldots \Phi( n_m)$$
3. 设$m=p_1^{α_1}p_2^{α_2}\ldots p_k^{α_k}$是m的标准分解式，$p_1, p_2,\ldots,p_k$是互不相同的素数，则
   $$\Phi (m)=m(1-1/p_1)(1-1/p_2)…(1-1/p_k)$$
   例如：$20=22\times51$，
   这样，$\Phi (20) =20\times(1-1/2)\times(1-1/5)=8$
### 欧拉定理
若$a$和$m$互素,则
$$a^{\Phi(m)}\equiv1\pmod m$$
另一种形式$a^{\Phi(m)+1}\equiv a\pmod m$
## 中国剩余定理
作用:**求n组线性同余方程的通解**
使用前提:对于$\forall i \in [1,n],x \equiv m_i(mod \quad a_i)$,其中若$m_1,m_2,\ldots,m_n$两两互质,则可以使用中国剩余定理来求解$x$
形式:
$$(S) : \begin{cases}
x \equiv a_1\pmod {m_1}\\
x \equiv a_2\pmod {m_2}\\
\quad\vdots\\
x \equiv a_n\pmod {m_n}\\
\end{cases}$$
公式:$x = \sum_{i=1}^n a_iM_iM_i^{-1}\pmod M$
$x≡M_1M_1^{-1}b_1 + M_2M_2^{-1}b_2 + \ldots + M_kM_k^{-1}b_k\pmod M$
$其 中M_i^{-1}  是 M_i 的逆元,M_i=M/m_i(除了m_i以外的乘积),M=m_1\times m_2\times m_3\times  \ldots \times m_n$
